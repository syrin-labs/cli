# Tool contract for order_food
# This tool recommends food based on weather conditions

version: 1
tool: order_food

contract:
  input_schema: OrderFoodRequest
  output_schema: FoodOrderResponse

guarantees:
  side_effects: none
  max_output_size: 1kb # Reduced to test output size validation

tests:
  - name: order_food_for_sunny_weather
    input:
      weather: 'Sunny'
    # Implicit success - inherits output_schema from contract

  - name: order_food_for_rainy_weather
    input:
      weather: 'Rainy'
    # Implicit success - inherits output_schema from contract

  - name: order_food_for_snowy_weather
    input:
      weather: 'Snowy'
    # Implicit success - inherits output_schema from contract

  # Test: Wrong type (number instead of string) - expects error
  - name: order_food_invalid_type
    input:
      weather: 12345
    expect:
      error:
        type: input_validation
        details:
          error_type: string_type
          field: weather
          expected: string
          received: int

  # Test: Boolean instead of string - expects error
  - name: order_food_boolean_input
    input:
      weather: true
    expect:
      error:
        type: input_validation
        details:
          error_type: string_type
          field: weather
          received: bool

  # Test: Array instead of string - expects error
  - name: order_food_array_input
    input:
      weather: ['Sunny', 'Rainy']
    expect:
      error:
        type: input_validation
        details:
          error_type: string_type
          field: weather
          received: list

  # Test: Object instead of string - expects error
  - name: order_food_object_input
    input:
      weather: { type: 'Sunny', temp: 25 }
    expect:
      error:
        type: input_validation
        details:
          error_type: string_type
          field: weather
          received: dict

  # Test: Missing required field - expects error
  - name: order_food_missing_weather
    input: {}
    expect:
      error:
        type: input_validation
        details:
          error_type: missing_argument
          field: weather

  # Test: Extra unexpected field - expects error
  - name: order_food_extra_field
    input:
      weather: 'Sunny'
      unexpected_field: 'value'
    expect:
      error:
        type: input_validation
        details:
          error_type: unexpected_keyword_argument
          field: unexpected_field

  # Test: Wrong output schema expectation
  - name: order_food_wrong_output_schema
    input:
      weather: 'Sunny'
    expect:
      output_schema: WrongSchemaName

  # Test: Empty string
  - name: order_food_empty_string
    input:
      weather: ''
    expect:
      output_schema: FoodOrderResponse

  # Test: Very long string (500 chars) - should succeed
  - name: order_food_very_long_string
    input:
      weather: 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
    # Implicit success - inherits output_schema from contract

  # Test: Unicode and emoji - should succeed
  - name: order_food_unicode
    input:
      weather: '‚òÄÔ∏èüåßÔ∏è‚ùÑÔ∏èÂ§©Ê∞î'
    # Implicit success - inherits output_schema from contract

  # Test: SQL injection attempt - should succeed (input validation handled by tool)
  - name: order_food_sql_injection
    input:
      weather: "'; DROP TABLE weather; --"
    # Implicit success - inherits output_schema from contract

  # Test: XSS attempt - should succeed (input validation handled by tool)
  - name: order_food_xss
    input:
      weather: "<script>alert('xss')</script>"
    # Implicit success - inherits output_schema from contract

  # Test: Newlines and special whitespace - should succeed
  - name: order_food_newlines
    input:
      weather: "Sunny\nRainy\tSnowy\r\n"
    # Implicit success - inherits output_schema from contract

  # Test: Only whitespace - should succeed (empty string is valid)
  - name: order_food_whitespace_only
    input:
      weather: "   \t\n  "
    # Implicit success - inherits output_schema from contract
